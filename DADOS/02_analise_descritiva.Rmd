---
title: "02_analise_descritiva.Rmd"
output: html_document
date: "2025-11-11"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(dplyr)      # O dono do pipe %>%
library(ggplot2)    # Gráficos
library(scales)     # Formatação de números
library(tibble)     # Tabelas melhores
library(knitr)      # Para o kable
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  fig.align = "center",
  out.width = "80%"
)
```

```{r carregar-dados, echo=FALSE}
caminho_dados_finais <- "enem_2024_GOIAS_filtrado_final.csv"

dados_enem <- fread(caminho_dados_finais)

#head(dados_enem)
#summary(dados_enem)
```

# Introdução: Análise de Desempenho dos Concluintes do ENEM 2024 em Goiás

## Contexto e Objetivo

O Exame Nacional do Ensino Médio (ENEM) é, atualmente, o principal instrumento de avaliação da educação básica brasileira e a porta de entrada para a vasta maioria das instituições de ensino superior públicas e privadas do país. Compreender os resultados do exame não é apenas uma forma de medir o desempenho acadêmico individual, mas também uma ferramenta poderosa para o diagnóstico de políticas públicas educacionais, identificação de disparidades e compreensão dos desafios enfrentados por diferentes grupos de estudantes.

O objetivo central deste relatório é realizar uma análise descritiva, comparativa e preditiva detalhada dos resultados do ENEM 2024, focando especificamente no desempenho dos estudantes do estado de Goiás.

## Escopo da Análise e Metodologia

Para garantir a relevância e a precisão das conclusões, esta análise utiliza uma base de dados cuidadosamente filtrada, que se concentra em um público-alvo específico:

**Localização:** A análise restringe-se exclusivamente aos participantes do estado de Goiás (GO).

**Perfil do Aluno:** O estudo foca apenas nos participantes "regulares", ou seja, aqueles que estavam cursando e concluindo o 3º ano do Ensino Médio no ano de 2024.

**Participação:** Foram excluídos da base todos os participantes que faltaram em um ou nos dois dias de prova, bem como aqueles que foram eliminados.

Essa filtragem é crucial, pois garante que a análise de desempenho (notas e acertos) seja feita apenas sobre o grupo de alunos que efetivamente completou todo o ciclo avaliativo do exame.

## Estrutura do Relatório

A análise está estruturada em etapas progressivas para construir um entendimento completo dos dados:

**Análise de Variáveis Qualitativas:** Inicia-se traçando o perfil demográfico dos participantes, investigando a distribuição por Tipo de Escola (Federal, Estadual, Privada, Municipal) e a escolha da Língua Estrangeira (Inglês ou Espanhol).

**Análise de Variáveis Quantitativas:** O núcleo da análise descritiva, onde avaliamos o desempenho acadêmico. Esta seção é dividida em:

  **Análise de Acertos (Discretas):** Verificação do número de acertos em cada uma das quatro provas objetivas (Ciências da Natureza, Ciências Humanas, Linguagens e Matemática).

  **Análise de Notas (Contínuas):** Avaliação das notas finais (calculadas via TRI) e da nota da Redação.

Em ambas as subseções, são utilizadas tabelas de frequência, medidas de tendência central e dispersão (média, mediana, quartis), e visualizações gráficas (Histogramas e Boxplots) para comparar o desempenho entre as áreas.

**Análise Comparativa (Cruzamento de Variáveis):** Esta seção aprofunda a investigação ao cruzar variáveis, buscando identificar padrões de desempenho. O foco é dado na comparação das notas de Matemática e Redação entre os diferentes tipos de administração escolar.

**Análise de Regressão Linear Simples:** Por fim, o relatório explora modelos preditivos simples para verificar a força da relação entre áreas correlatas, investigando se o desempenho em Ciências da Natureza pode prever a nota de Matemática, e se os acertos em Linguagens têm poder preditivo sobre a nota final da Redação.

***

## Análise das Variáveis Qualitativas

### Análise: Tipo de Escola (`TP_DEPENDENCIA_ADM_ESC`)

```{r analise-qualitativa-escola, echo=FALSE}
# 1. Tabela de Frequência Absoluta
tabela_escola <- table(dados_enem$TP_DEPENDENCIA_ADM_ESC)

# 2. Tabela de Porcentagem
tabela_escola_porc <- round(100 * prop.table(tabela_escola), 2)

# 3. ATRIBUIR OS NOMES CORRETOS DIRETAMENTE NA VARIÁVEL
# (1=Federal, 2=Estadual, 3=Municipal, 4=Privada)
names(tabela_escola_porc) <- c("Federal", "Estadual", "Municipal", "Privada")

# 4. Gráfico de Barras (com rótulos corretos)
barplot(tabela_escola_porc,
        main="Tipo de Escola dos Participantes (GO)",
        ylab="Porcentagem (%)",
        xlab="Tipo de Dependência Administrativa",
        col="darkblue"
)
```

**Interpretação da Análise de Tipo de Escola**

A análise da `TP_DEPENDENCIA_ADM_ESC` mostra o perfil claro dos participantes de escolas de Goiás. A grande maioria, **`r tabela_escola_porc["Estadual"]`%**, provém de escolas **Estaduais**.

Em segundo lugar, com **`r tabela_escola_porc["Privada"]`%**, estão os alunos de escolas **Privadas**, seguidos por **`r tabela_escola_porc["Federal"]`%** de escolas **Federais**.

Como esperado para participantes do Ensino Médio, a participação de escolas **Municipais** é estatisticamente nula, com apenas **`r tabela_escola_porc["Municipal"]`%**.

***

### Análise: Tipo da Língua Estrangeira (`TP_LINGUA`)

```{r analise-lingua, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)
library(scales)

# 1. Preparação dos Dados
analise_lingua <- dados_enem %>%
  count(TP_LINGUA) %>%
  mutate(
    # Cria uma coluna com o NOME da língua para ficar bonito no gráfico
    Lingua = case_when(
      TP_LINGUA == 0 ~ "Inglês",
      TP_LINGUA == 1 ~ "Espanhol"
    ),
    Porcentagem = n / sum(n) * 100
  )

# 2. Gráfico de Barras
ggplot(analise_lingua, aes(x = Lingua, y = n)) +
  geom_bar(stat = "identity", fill = "steelblue", color = "black", width = 0.6) +
  geom_text(aes(label = paste0(n, " (", round(Porcentagem, 1), "%)")), 
            vjust = -0.5, fontface = "bold") +
  scale_y_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.15))) +
  labs(
    title = "Distribuição da Escolha de Língua Estrangeira",
    subtitle = "Total de alunos presentes por idioma escolhido",
    x = "Idioma Escolhido",
    y = "Quantidade de Alunos"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 14, face = "bold"),
    axis.text = element_text(size = 11),
    panel.grid.major.x = element_blank()
  )

# 1. Identificar a língua mais escolhida (Top 1)
top_lingua <- analise_lingua %>% 
  filter(n == max(n))

# 2. Identificar a língua menos escolhida
bottom_lingua <- analise_lingua %>% 
  filter(n == min(n))

# 3. Formatar os números para texto (Ex: 24.820 e 56,7%)
# O format() coloca o ponto de milhar
# O sub() troca ponto decimal por vírgula se necessário

nome_maioria <- top_lingua$Lingua
qtd_maioria  <- format(top_lingua$n, big.mark = ".", decimal.mark = ",")
perc_maioria <- gsub("\\.", ",", round(top_lingua$Porcentagem, 1))

nome_minoria <- bottom_lingua$Lingua
qtd_minoria  <- format(bottom_lingua$n, big.mark = ".", decimal.mark = ",")
perc_minoria <- gsub("\\.", ",", round(bottom_lingua$Porcentagem, 1))
```

**Interpretação da Análise de Língua Estrangeira**

A distribuição da escolha de Língua Estrangeira apresenta um cenário competitivo, porém com uma liderança definida da língua **`r nome_maioria`**.

Observa-se que a maioria dos estudantes (**`r perc_maioria`%**, ou **`r qtd_maioria`** alunos) optou pelo **`r nome_maioria`** como idioma de prova, enquanto o **`r nome_minoria`** foi a escolha de **`r perc_minoria`%** (**`r qtd_minoria`** alunos).

Este dado é particularmente interessante quando cruzado com a análise anterior: mesmo com a grande predominância de alunos da rede estadual pública, a preferência pelo **`r nome_maioria`** se mostra superior neste grupo de concluintes.

***

## Análise das Variáveis Quantitativas Discretas EM CONJUNTO

### Estatísticas descritivas dos acertos ENEM
```{r medidas-descritivas-acertos, echo=FALSE}
# Pacotes úteis
library(dplyr)
library(tibble)

# Seleciona apenas as colunas de interesse
acertos <- dados_enem %>%
  select(ACERTOS_CN, ACERTOS_CH, ACERTOS_LC, ACERTOS_MT)

# Função para calcular as medidas descritivas de uma variável numérica
medidas <- function(x) {
  moda <- as.numeric(names(sort(table(x), decreasing = TRUE))[1])  # Moda simples
  media <- mean(x, na.rm = TRUE)
  mediana <- median(x, na.rm = TRUE)
  quartis <- quantile(x, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)
  variancia <- var(x, na.rm = TRUE)
  desvio <- sd(x, na.rm = TRUE)
  cv <- (desvio / media) * 100
  
  c(
    Média = media,
    Mediana = mediana,
    Moda = moda,
    Q1 = quartis[1],
    Q3 = quartis[3],
    Variância = variancia,
    `Desvio Padrão` = desvio,
    `Coeficiente de Variação (%)` = cv
  )
}

# Aplica a função para cada área
tabela_medidas <- data.frame(
  `Ciências da Natureza` = medidas(acertos$ACERTOS_CN),
  `Ciências Humanas` = medidas(acertos$ACERTOS_CH),
  `Linguagens` = medidas(acertos$ACERTOS_LC),
  `Matemática` = medidas(acertos$ACERTOS_MT)
)

# Transforma em tibble para exibir de forma mais organizada
tabela_medidas <- tibble::rownames_to_column(as.data.frame(tabela_medidas), "Medida")

# Mostra a tabela
knitr::kable(tabela_medidas, caption = "Medidas descritivas dos acertos do ENEM 2024", digits = 2)
```


### Tabelas de Frequências dos Acertos


#### Acertos Ciências da Natureza
```{r tabela-frequencias-1, echo=FALSE}
acertos_cn <- na.omit(dados_enem$ACERTOS_CN)
intervalos_cn <- cut(
  acertos_cn,
  breaks = seq(0, max(acertos_cn) + 4.999, by = 5), 
  right = FALSE, include.lowest = TRUE
)
freq_abs_cn <- table(intervalos_cn)
freq_rel_cn <- round(prop.table(freq_abs_cn) * 100, 2)
freq_acum_cn <- cumsum(freq_rel_cn)
tabela_freq_cn <- data.frame(
  "Intervalo de Acertos" = names(freq_abs_cn),
  "Frequência Absoluta" = as.vector(freq_abs_cn),
  "Frequência Relativa (%)" = as.vector(freq_rel_cn),
  "Frequência Acumulada (%)" = as.vector(freq_acum_cn)
)
knitr::kable(
  tabela_freq_cn,
  caption = "Tabela 1.1: Distribuição de Frequência - Acertos em Ciências da Natureza (GO)",
  align = "c"
)
```


#### Acertos Ciências Humanas
```{r tabela-frequencias-2, echo=FALSE}
acertos_ch <- na.omit(dados_enem$ACERTOS_CH)
intervalos_ch <- cut(
  acertos_ch,
  breaks = seq(0, max(acertos_ch) + 4.999, by = 5), # CORRIGIDO
  right = FALSE, include.lowest = TRUE
)
freq_abs_ch <- table(intervalos_ch)
freq_rel_ch <- round(prop.table(freq_abs_ch) * 100, 2)
freq_acum_ch <- cumsum(freq_rel_ch)
tabela_freq_ch <- data.frame(
  "Intervalo de Acertos" = names(freq_abs_ch),
  "Frequência Absoluta" = as.vector(freq_abs_ch),
  "Frequência Relativa (%)" = as.vector(freq_rel_ch),
  "Frequência Acumulada (%)" = as.vector(freq_acum_ch)
)
knitr::kable(
  tabela_freq_ch,
  caption = "Tabela 1.2: Distribuição de Frequência - Acertos em Ciências Humanas (GO)",
  align = "c"
)
```


#### Acertos Matemática
```{r tabela-frequencias-3, echo=FALSE}
acertos_mt <- na.omit(dados_enem$ACERTOS_MT)
intervalos_mt <- cut(
  acertos_mt,
  breaks = seq(0, max(acertos_mt) + 4.999, by = 5), # CORRIGIDO
  right = FALSE, include.lowest = TRUE
)
freq_abs_mt <- table(intervalos_mt)
freq_rel_mt <- round(prop.table(freq_abs_mt) * 100, 2)
freq_acum_mt <- cumsum(freq_rel_mt)
tabela_freq_mt <- data.frame(
  "Intervalo de Acertos" = names(freq_abs_mt),
  "Frequência Absoluta" = as.vector(freq_abs_mt),
  "Frequência Relativa (%)" = as.vector(freq_rel_mt),
  "Frequência Acumulada (%)" = as.vector(freq_acum_mt)
)
knitr::kable(
  tabela_freq_mt,
  caption = "Tabela 1.3: Distribuição de Frequência - Acertos em Matemática (GO)",
  align = "c"
)
```


#### Acertos Linguagens
```{r tabela-frequencias-4, echo=FALSE}
acertos_lc <- na.omit(dados_enem$ACERTOS_LC)
intervalos_lc <- cut(
  acertos_lc,
  breaks = seq(0, max(acertos_lc) + 4.999, by = 5), # CORRIGIDO
  right = FALSE, include.lowest = TRUE
)
freq_abs_lc <- table(intervalos_lc)
freq_rel_lc <- round(prop.table(freq_abs_lc) * 100, 2)
freq_acum_lc <- cumsum(freq_rel_lc)
tabela_freq_lc <- data.frame(
  "Intervalo de Acertos" = names(freq_abs_lc),
  "Frequência Absoluta" = as.vector(freq_abs_lc),
  "Frequência Relativa (%)" = as.vector(freq_rel_lc),
  "Frequência Acumulada (%)" = as.vector(freq_acum_lc)
)
knitr::kable(
  tabela_freq_lc,
  caption = "Tabela 1.4: Distribuição de Frequência - Acertos em Linguagens (GO)",
  align = "c"
)
```

### Histogramas
```{r analise-discreta-acertos-conjunto, echo=FALSE}
# 1. Definir as colunas que vamos analisar
cols_discretas <- c("ACERTOS_CN", "ACERTOS_CH", "ACERTOS_LC", "ACERTOS_MT")

# 2. Calcular as medidas (CORREÇÃO DEFINITIVA: argumentos nomeados)
medias_acertos <- round(sapply(dados_enem[, ..cols_discretas], mean, na.rm = TRUE), 2)
medianas_acertos <- sapply(dados_enem[, ..cols_discretas], median, na.rm = TRUE)
q1_acertos <- sapply(dados_enem[, ..cols_discretas], quantile, probs = 0.25, na.rm = TRUE, names = FALSE)
q3_acertos <- sapply(dados_enem[, ..cols_discretas], quantile, probs = 0.75, na.rm = TRUE, names = FALSE)

# 3. Criar dataframes filtrados (para os gráficos, remover ausentes)
presentes_dia1 <- dados_enem[!is.na(NU_NOTA_CH) & !is.na(NU_NOTA_LC)] # Ausentes CH/LC
presentes_dia2 <- dados_enem[!is.na(NU_NOTA_CN) & !is.na(NU_NOTA_MT)] # Ausentes CN/MT

# 4. Configurar a janela gráfica para um grid 2x2
par(mfrow = c(2, 2))

# 5. Gerar os 4 histogramas USANDO OS DADOS FILTRADOS e BREAKS DE 5 EM 5
hist(presentes_dia2$ACERTOS_CN, main="Acertos em CN (Presentes)", xlab="Acertos", ylab="Freq.", col="blue", breaks = seq(0, 45, by = 5), right = FALSE)
hist(presentes_dia1$ACERTOS_CH, main="Acertos em CH (Presentes)", xlab="Acertos", ylab="Freq.", col="red", breaks = seq(0, 45, by = 5), right = FALSE)
hist(presentes_dia1$ACERTOS_LC, main="Acertos em LC (Presentes)", xlab="Acertos", ylab="Freq.", col="green", breaks = seq(0, 45, by = 5), right = FALSE)
hist(presentes_dia2$ACERTOS_MT, main="Acertos em MT (Presentes)", xlab="Acertos", ylab="Freq.", col="purple", breaks = seq(0, 45, by = 5), right = FALSE)
```

### Boxplots
```{r analise-discretas-acertos-boxplot, echo=FALSE}
# 1. Criamos os vetores de nomes e cores

rotulos_areas <- c("Natureza", "Humanas", "Linguagens", "Matemática")
cores_areas <- c("darkgreen", "darkblue", "darkorange", "darkred")

# 2. Reunimos as notas em um único data frame

acertos_enem <- data.frame(
Natureza = dados_enem$ACERTOS_CN,
Humanas = dados_enem$ACERTOS_CH,
Linguagens = dados_enem$ACERTOS_LC,
Matematica = dados_enem$ACERTOS_MT
)

# 3. Geramos o boxplot comparativo

boxplot(acertos_enem,
main = "Acertos por Área do ENEM (GO)",
ylab = "Acertos",
xlab = "Área de Conhecimento",
names = rotulos_areas,
col = cores_areas,
border = "black",
notch = FALSE)

# 4. Calculamos as medianas por área

medianas_por_area <- apply(acertos_enem, 2, median, na.rm = TRUE)

# 5. Salvamos em variáveis para uso no texto (se desejar citar no relatório)

med_natureza <- round(medianas_por_area["Natureza"], 2)
med_humanas <- round(medianas_por_area["Humanas"], 2)
med_linguagens <- round(medianas_por_area["Linguagens"], 2)
med_matematica <- round(medianas_por_area["Matematica"], 2)

```

**Interpretação da Análise de Acertos de Todas as Áreas**

Os Histogramas ilustram visualmente a distribuição do número de acertos (dos alunos presentes) nas quatro áreas de prova. É possível observar um padrão consistente em todas elas: uma clara **assimetria à direita** (ou assimetria positiva), o que significa que a maioria dos alunos se concentra nas faixas de acertos mais baixas.

Comparativamente, as provas de Linguagens (LC) e Humanas (CH) apresentam medianas de acertos mais altas do que Ciências da Natureza (CN) e Matemática (MT), indicando um desempenho geral superior nas provas do primeiro dia.

Os summaries estatísticos confirmam essa tendência:

Ciências da Natureza (CN): A média de acertos foi de **`r medias_acertos["ACERTOS_CN"]`**, enquanto a mediana (o valor central, 50%) foi de **`r medianas_acertos["ACERTOS_CN"]`**. 
50% dos alunos (o intervalo interquartil) acertaram entre **`r q1_acertos["ACERTOS_CN"]`** (1º Quartil) e **`r q3_acertos["ACERTOS_CN"]`** (3º Quartil) questões.

Ciências Humanas (CH): A média de acertos foi de **`r medias_acertos["ACERTOS_CH"]`**, enquanto a mediana foi de **`r medianas_acertos["ACERTOS_CH"]`**. 
50% dos alunos acertaram entre **`r q1_acertos["ACERTOS_CH"]`** (1º Quartil) e **`r q3_acertos["ACERTOS_CH"]`** (3º Quartil) questões.

Linguagens e Códigos (LC): A média de acertos foi de **`r medias_acertos["ACERTOS_LC"]`**, enquanto a mediana foi de **`r medianas_acertos["ACERTOS_LC"]`**. 
50% dos alunos acertaram entre **`r q1_acertos["ACERTOS_LC"]`** (1º Quartil) e **`r q3_acertos["ACERTOS_LC"]`** (3º Quartil) questões.

Matemática (MT): A média de acertos foi de **`r medias_acertos["ACERTOS_MT"]`**, enquanto a mediana foi de **`r medianas_acertos["ACERTOS_MT"]`**. 
50% dos alunos acertaram entre **`r q1_acertos["ACERTOS_MT"]`** (1º Quartil) e **`r q3_acertos["ACERTOS_MT"]`** (3º Quartil) questões.

No boxplot comparativo, a diferença entre as áreas (em número de acertos) se torna mais evidente.

**Ciências Humanas** se destaca com a **maior mediana** (a linha central, em r med_humanas acertos), indicando o **melhor desempenho geral**. Esta área também apresenta a **maior variabilidade no intervalo interquartil** (a "caixa" é a mais alta), mostrando **maior dispersão** no desempenho dos 50% centrais dos alunos.

**Linguagens** apresenta um **desempenho intermediário**, com a **segunda maior mediana** (**`r med_linguagens`** acertos). Notavelmente, possui a "caixa" mais "curta", indicando que a maioria dos alunos teve um número de acertos muito próximo da mediana.

**Ciências da Natureza e Matemática** concentram as **menores medianas** (**`r med_natureza`** e **`r med_matematica`** acertos, respectivamente), com valores muito próximos entre si. Ambas as áreas, juntamente com Humanas, também apresentam uma **quantidade significativa de valores atípicos** (outliers) superiores, mostrando que, embora o desempenho mediano seja baixo, um grupo de alunos conseguiu um número de acertos muito acima da média.

Em termos quantitativos, as **medianas** (em número de acertos) calculadas foram aproximadamente:

**Natureza: `r med_natureza`** acertos

**Humanas: `r med_humanas`** acertos

**Linguagens: `r med_linguagens`** acertos

**Matemática: `r med_matematica`** acertos

De modo geral, a análise do número de acertos confirma que os participantes de Goiás tendem a ter um desempenho mediano melhor na prova de Ciências Humanas, seguido por Linguagens, e um desempenho mais baixo em Matemática e Ciências da Natureza.

***

## Análise das Variáveis Quantitativas Contínuas EM CONJUNTO

### Estatísticas descritivas das notas ENEM
```{r medidas-descritivas-notas, echo=FALSE}
# Pacotes úteis
library(dplyr)
library(tibble)

# Seleciona apenas as colunas de interesse
notas <- dados_enem %>%
  select(NU_NOTA_CN, NU_NOTA_CH, NU_NOTA_LC, NU_NOTA_MT, NU_NOTA_REDACAO)

# Função para calcular as medidas descritivas de uma variável numérica
medidas <- function(x) {
  moda <- as.numeric(names(sort(table(x), decreasing = TRUE))[1])  # Moda simples
  media <- mean(x, na.rm = TRUE)
  mediana <- median(x, na.rm = TRUE)
  quartis <- quantile(x, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)
  variancia <- var(x, na.rm = TRUE)
  desvio <- sd(x, na.rm = TRUE)
  cv <- (desvio / media) * 100
  
  c(
    Média = media,
    Mediana = mediana,
    Moda = moda,
    Q1 = quartis[1],
    Q3 = quartis[3],
    Variância = variancia,
    `Desvio Padrão` = desvio,
    `Coeficiente de Variação (%)` = cv
  )
}

# Aplica a função para cada área
tabela_medidas <- data.frame(
  `Ciências da Natureza` = medidas(notas$NU_NOTA_CN),
  `Ciências Humanas` = medidas(notas$NU_NOTA_CH),
  `Linguagens` = medidas(notas$NU_NOTA_LC),
  `Matemática` = medidas(notas$NU_NOTA_MT),
  `Redação` = medidas(notas$NU_NOTA_REDACAO)
)

# Transforma em tibble para exibir de forma mais organizada
tabela_medidas <- tibble::rownames_to_column(as.data.frame(tabela_medidas), "Medida")

# Mostra a tabela
knitr::kable(tabela_medidas, caption = "Medidas descritivas das notas do ENEM 2024", digits = 2)
```

### Histogramas
```{r analise-continua-notas-histograma, echo=FALSE}
# Layout compacto com par(mfrow): Histogramas de todas as áreas do ENEM

# Define layout: 2 linhas, 3 colunas
par(mfrow = c(2, 3))

# Histograma - Ciências da Natureza
hist(dados_enem$NU_NOTA_CN,
     main = "Ciências da Natureza",
     xlab = "Nota",
     ylab = "Frequência",
     col = "darkgreen",
     breaks = 20)

# Histograma - Ciências Humanas
hist(dados_enem$NU_NOTA_CH,
     main = "Ciências Humanas",
     xlab = "Nota",
     ylab = "Frequência",
     col = "darkblue",
     breaks = 20)

# Histograma - Linguagens
hist(dados_enem$NU_NOTA_LC,
     main = "Linguagens",
     xlab = "Nota",
     ylab = "Frequência",
     col = "darkorange",
     breaks = 20)

# Histograma - Redação
hist(dados_enem$NU_NOTA_REDACAO,
     main = "Redação",
     xlab = "Nota",
     ylab = "Frequência",
     col = "purple",
     breaks = 20)

# Histograma - Matemática
hist(dados_enem$NU_NOTA_MT,
     main = "Matemática",
     xlab = "Nota",
     ylab = "Frequência",
     col = "darkred",
     breaks = 20)

# Voltar ao layout padrão
par(mfrow = c(1, 1))
```

### Boxplots
```{r analise-continua-notas-boxplot, echo=FALSE}
# 1. Criamos os vetores de nomes e cores

rotulos_areas <- c("Natureza", "Humanas", "Linguagens", "Redação", "Matemática")
cores_areas <- c("darkgreen", "darkblue", "darkorange", "purple", "darkred")

# 2. Reunimos as notas em um único data frame

notas_enem <- data.frame(
Natureza = dados_enem$NU_NOTA_CN,
Humanas = dados_enem$NU_NOTA_CH,
Linguagens = dados_enem$NU_NOTA_LC,
Redacao = dados_enem$NU_NOTA_REDACAO,
Matematica = dados_enem$NU_NOTA_MT
)

# 3. Geramos o boxplot comparativo

boxplot(notas_enem,
main = "Notas por Área do ENEM (GO)",
ylab = "Nota",
xlab = "Área de Conhecimento",
names = rotulos_areas,
col = cores_areas,
border = "black",
notch = FALSE)

# 4. Calculamos as medianas por área

medianas_por_area <- apply(notas_enem, 2, median, na.rm = TRUE)

# 5. Salvamos em variáveis para uso no texto (se desejar citar no relatório)

med_natureza <- round(medianas_por_area["Natureza"], 2)
med_humanas <- round(medianas_por_area["Humanas"], 2)
med_linguagens <- round(medianas_por_area["Linguagens"], 2)
med_redacao <- round(medianas_por_area["Redacao"], 2)
med_matematica <- round(medianas_por_area["Matematica"], 2)

```

**Interpretação da Análise das Notas por Área do ENEM (GO)**

Os gráficos apresentados permitem observar a distribuição e o comportamento das notas nas cinco áreas avaliadas pelo ENEM — Ciências da Natureza, Ciências Humanas, Linguagens, Redação e Matemática — entre os participantes de Goiás.

Nos histogramas, nota-se que todas as áreas apresentam distribuições assimétricas, mas com padrões distintos. As **provas objetivas** (Natureza, Humanas, Linguagens e Matemática) mostram uma concentração de notas nas faixas **intermediárias** (entre 400 e 600 pontos), com **assimetria à direita** (cauda voltada para as notas mais altas). Isso indica que a maior parte dos alunos obteve desempenho mediano, com poucos atingindo pontuações muito elevadas.
A prova de **Redação**, por outro lado, apresenta um comportamento mais **disperso**, com picos em **diferentes faixas de pontuação** e presença de **valores muito baixos**, o que sugere maior heterogeneidade no desempenho dos participantes.

No boxplot comparativo, a diferença entre as áreas se torna mais evidente.

- **Linguagens e Redação** se destacam com as **maiores medianas**, indicando melhor desempenho geral nessas áreas.

- **Ciências Humanas** apresenta desempenho **intermediário**, próximo ao de Linguagens.

- **Ciências da Natureza** e, principalmente, **Matemática**, concentram as **menores medianas** e **maior presença de valores atípicos** (outliers) abaixo do limite inferior, evidenciando o desafio que essas disciplinas ainda representam para os candidatos.

Em termos quantitativos, as medianas calculadas foram aproximadamente:

- **Natureza: `r med_natureza`** pontos

- **Humanas: `r med_humanas`** pontos

- **Linguagens: `r med_linguagens`** pontos

- **Redação: `r med_redacao`** pontos

- **Matemática: `r med_matematica`** pontos

De modo geral, as análises confirmam que os participantes de Goiás tendem a ter desempenho melhor nas áreas de Linguagens e Redação, e mais baixo em Matemática e Ciências da Natureza, padrão compatível com o observado em outras edições do ENEM.

***

## Análise Comparativa (Cruzamento de Variáveis)

Esta é a parte mais importante da análise descritiva, onde cruzamos variáveis qualitativas e quantitativas.

### Análise: Nota de Matemática vs. Tipo de Escola

```{r analise-comparativa-boxplot, echo=FALSE}
# 1. Criamos os vetores de nomes e cores
rotulos_escola <- c("Federal", "Estadual", "Municipal", "Privada")
cores_escola <- c("blue", "green", "orange", "red")

# 2. Geramos o Boxplot
boxplot(dados_enem$NU_NOTA_MT ~ dados_enem$TP_DEPENDENCIA_ADM_ESC,
        main="Notas de Mat. por Tipo de Escola",
        ylab="Nota de Matemática",
        xlab="Tipo de Escola",
        names = rotulos_escola,  
        col = cores_escola       
)

# 3. CALCULAMOS AS ESTATÍSTICAS PARA O TEXTO
# (Usamos 'tapply' para calcular a mediana por grupo)
medianas_por_grupo <- tapply(dados_enem$NU_NOTA_MT,
                                 dados_enem$TP_DEPENDENCIA_ADM_ESC,
                                 median,
                                 na.rm = TRUE)

# 4. Salvar em variáveis fáceis de usar no texto
med_federal <- round(medianas_por_grupo["1"], 2)
med_estadual <- round(medianas_por_grupo["2"], 2)
med_municipal <- round(medianas_por_grupo["3"], 2)
med_privada <- round(medianas_por_grupo["4"], 2)
```

**Interpretação da Análise Comparativa**

Esse gráfico bloxpot é uma das análises mais reveladoras deste trabalho, pois compara o desempenho em Matemática (`NU_NOTA_MT`) entre os diferentes tipos de administração escolar (`TP_DEPENDENCIA_ADM_ESC`).

A diferença de desempenho é nítida:

1.  **Escolas Federais:** Apresentam o melhor desempenho. A mediana (a linha grossa) deste grupo é de **`r med_federal`** pontos, a mais alta entre todas as categorias.
2.  **Escolas Privadas:** Ficam em segundo lugar, com uma mediana de **`r med_privada`** pontos, um valor visivelmente superior ao das escolas Estaduais.
3.  **Escolas Estaduais:** Este grupo, que representa a grande maioria dos participantes (**`r tabela_escola_porc["Estadual"]`%**), apresenta uma mediana de **`r med_estadual`** pontos.
4.  **Escolas Municipais:** Este grupo, estatisticamente pequeno (**`r tabela_escola_porc["Municipal"]`%**), apresenta o menor desempenho, com uma mediana de **`r med_municipal`** pontos.

Em suma, o gráfico demonstra uma forte correlação entre a dependência administrativa da escola e o desempenho dos alunos na prova de matemática em Goiás.

***

### Análise: Nota da Redação vs. Tipo de Escola
```{r analise-comparativa-boxplot-redacao, echo=FALSE}
# 1. Criamos os vetores de nomes e cores
rotulos_escola <- c("Federal", "Estadual", "Municipal", "Privada")
cores_escola <- c("blue", "green", "orange", "red")

# 2. Geramos o Boxplot
boxplot(dados_enem$NU_NOTA_RED ~ dados_enem$TP_DEPENDENCIA_ADM_ESC,
        main="Nota de Redação por Tipo de Escola",
        ylab="Nota de Redação",
        xlab="Tipo de Escola",
        names = rotulos_escola,
        col = cores_escola
)

# 3. CALCULAMOS AS ESTATÍSTICAS PARA O TEXTO
medianas_por_grupo <- tapply(dados_enem$NU_NOTA_RED,
                             dados_enem$TP_DEPENDENCIA_ADM_ESC,
                             median,
                             na.rm = TRUE)

# 4. Salvar em variáveis fáceis de usar no texto
med_federal <- round(medianas_por_grupo["1"], 2)
med_estadual <- round(medianas_por_grupo["2"], 2)
med_municipal <- round(medianas_por_grupo["3"], 2)
med_privada <- round(medianas_por_grupo["4"], 2)
```

**Interpretação da Análise Comparativa**

O gráfico que compara o desempenho em Redação (NU_NOTA_RED) entre os diferentes tipos de administração escolar (TP_DEPENDENCIA_ADM_ESC) também revela diferenças importantes entre os grupos analisados.

Os resultados seguem uma tendência clara:

1.  **Escolas Federais:** Ficam em segundo lugar, com mediana de **`r med_federal`** pontos.
Embora apresentem excelentes resultados, ainda ficam ligeiramente abaixo das escolas privadas no desempenho mediano.

2.  **Escolas Privadas:** Apresentam o melhor desempenho em Redação.
A mediana deste grupo é de **`r med_privada` pontos, a maior entre todas as categorias, indicando um desempenho consistentemente superior.

3.  **Escolas Municipais:** Este grupo, que possui participação reduzida (**`r tabela_escola_porc["Municipal"]`%**), apresenta a menor mediana entre os tipos de escola, com r med_municipal pontos.
O resultado reflete desafios estruturais mais evidentes nessa rede.

4.  **Escolas Estaduais:** Representando a maior parcela dos participantes (**`r tabela_escola_porc["Estadual"]`%**), apresentam uma mediana de **`r med_estadual`** pontos — inferior às redes Federal e Privada, mas superior às Municipais.

***

## Análise de Regressão Linear Simples

O foco da análise de regressão linear simples serve para verificar se uma variável quantitativa pode prever o comportamento de outra.

### Análise: `NU_NOTA_MT` vs. `NU_NOTA_CN`

Para esta análise, vamos investigar se a nota em **Ciências da Natureza (`NU_NOTA_CN`)** pode ser usada para prever a nota em **Matemática (`NU_NOTA_MT`)**.

* Variável Dependente (Y): `NU_NOTA_MT`
* Variável Independente (X): `NU_NOTA_CN`

```{r analise-regressao, echo=FALSE}
# 1. Ajustar o modelo de regressão linear
# Usamos a fórmula lm(Y ~ X, data = dados_enem)
modelo_regressao <- lm(NU_NOTA_MT ~ NU_NOTA_CN, data = dados_enem)

# 2. Obter o resumo estatístico do modelo
summary_modelo <- summary(modelo_regressao)

# 3. Salvar as estatísticas importantes em variáveis
# Coeficientes
coeficientes <- summary_modelo$coefficients
intercepto_b0 <- round(coeficientes[1, 1], 4) # Valor de B0
slope_b1 <- round(coeficientes[2, 1], 4)      # Valor de B1
p_valor <- coeficientes[2, 4]                 # P-valor do B1

# R-quadrado (Quanto o modelo explica)
r_quadrado <- round(summary_modelo$r.squared, 4)

# 4. Gerar o Gráfico de Dispersão
plot(dados_enem$NU_NOTA_CN, dados_enem$NU_NOTA_MT,
     main="Regressão Linear - Nota Mat. vs. Nota CN",
     xlab="Nota Ciências da Natureza (X)",
     ylab="Nota Matemática (Y)",
     pch = 19, # Tipo de ponto (círculo pequeno)
     cex = 0.5, # Tamanho do ponto
     col = "blue"
)

# 5. Adicionar a linha de regressão ao gráfico
abline(modelo_regressao, col = "red", lwd = 3) # lwd = espessura da linha
```

**Interpretação da Análise de Regressão**

Esse gráfico mostra o diagrama de dispersão entre as notas de Ciências da Natureza (eixo X) e Matemática (eixo Y). A linha vermelha representa o modelo de regressão linear simples.

Visualmente, os pontos formam uma nuvem que sobe da esquerda para a direita, indicando uma **correlação linear positiva** entre as duas variáveis: quanto maior a nota em CN, maior tende a ser a nota em MT.

**Interpretação do Modelo Estatístico**

O resumo do modelo estatístico nos fornece os seguintes indicadores-chave:

1.  **Coeficientes (A Equação da Reta):**
    * **Intercepto (B0):** `r intercepto_b0`. Este é o valor teórico da nota de Matemática se a nota de CN fosse zero.
    * **Slope (B1 - `NU_NOTA_CN`):** `r slope_b1`. Este é o coeficiente mais importante. Ele indica que, em média, para cada **1 ponto** de aumento na nota de Ciências da Natureza, espera-se um aumento de **`r slope_b1`** pontos na nota de Matemática.

2.  **Coeficiente de Determinação (R²):**
    * O R-quadrado do modelo foi de **`r r_quadrado`**. Isso significa que **`r r_quadrado * 100`%** da variação nas notas de Matemática podem ser estatisticamente explicadas pela variação nas notas de Ciências da Natureza.

3.  **Significância (P-Valor):**
    * O P-valor para o coeficiente B1 foi de **`r p_valor`** (ou um valor muito próximo de zero). Como este valor é muito menor que 0.05, confirmamos que a relação entre as duas notas é **estatisticamente significante**.

***

### Análise: `NU_NOTA_REDACAO` vs. `ACERTOS_LC`

O objetivo desta próxima análise é verificar se o desempenho do participante em **Linguagens e Códigos (ACERTOS_LC)** pode ser usado para prever sua **nota de Redação (NU_NOTA_REDACAO)**.

* Variável Dependente (Y): `NU_NOTA_REDACAO`
* Variável Independente (X): `ACERTOS_LC`

```{r regressao-red-lc, echo=FALSE}
# 1. Ajustar o modelo de regressão linear
modelo_red_lc <- lm(NU_NOTA_REDACAO ~ ACERTOS_LC, data = dados_enem)

# 2. Obter o resumo estatístico do modelo
summary_red_lc <- summary(modelo_red_lc)

# 3. Extrair estatísticas importantes
coeficientes <- summary_red_lc$coefficients
intercepto_b0 <- round(coeficientes[1, 1], 4)   # Intercepto B0
slope_b1 <- round(coeficientes[2, 1], 4)        # Inclinação B1
p_valor <- coeficientes[2, 4]                   # P-valor
r_quadrado <- round(summary_red_lc$r.squared, 4) # R-quadrado

# 4. Gerar gráfico de dispersão
plot(dados_enem$ACERTOS_LC, dados_enem$NU_NOTA_REDACAO,
     main="Gráfico 8: Regressão Linear - Nota Redação vs. Acertos em LC",
     xlab="Acertos em Linguagens (X)",
     ylab="Nota de Redação (Y)",
     pch = 19,
     cex = 0.5,
     col = "blue"
)

# 5. Adicionar a linha de regressão ao gráfico
abline(modelo_red_lc, col = "red", lwd = 3)
```

**Interpretação da Análise de Regressão**

O gráfico acima mostra o diagrama de dispersão entre o número de acertos em Linguagens (eixo X) e a nota de Redação (eixo Y). A linha vermelha representa o modelo de regressão linear simples.

Visualmente, os pontos formam uma nuvem que sobe da esquerda para a direita, indicando uma **correlação linear positiva** entre as duas variáveis: quanto maior o número de acertos em LC, maior tende a ser a nota de Redação.

**Interpretação do Modelo Estatístico**

O resumo do modelo estatístico nos fornece os seguintes indicadores-chave:

1. **Coeficientes (A Equação da Reta)**
    * **Intercepto (B0):** `r intercepto_b0`.  
  Este é o valor teórico da nota de Redação caso o participante tivesse **0 acertos em Linguagens**.
    * **Slope (B1 – ACERTOS_LC):** `r slope_b1`.  
  Esse é o coeficiente mais importante. Ele indica que, em média, para cada **1 acerto adicional** em Linguagens, espera-se um aumento de **`r slope_b1`** pontos na nota de Redação.

2. **Coeficiente de Determinação (R²)**
    * O R-quadrado encontrado foi de **`r r_quadrado`**.  
Isso significa que **`r r_quadrado * 100`%** da variação nas notas de Redação pode ser explicada pelas diferenças no número de acertos em Linguagens.

3. **Significância (P-Valor)**
    * O P-valor do coeficiente B1 é **`r p_valor`** (muito próximo de zero).  
Como este valor é muito menor que 0.05, concluímos que a relação entre acertos em LC e nota de Redação é **estatisticamente significante**.