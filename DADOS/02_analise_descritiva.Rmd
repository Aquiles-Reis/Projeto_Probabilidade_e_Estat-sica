---
title: "Análise Descritiva: Desempenho no ENEM 2024 dos Concluintes de Goiás"
author: 
- "Adriam Felipe Santos da Luz"  
- "Fernando Cardoso Houara Brêttas"  
- "Filipe Campos Matunaga Batista"  
- "Gabriel Freitas Brandão"  
- "João Aquiles Lemos Reis"
output: pdf_document
geometry: "left=2.5cm, right=2.5cm, top=2.5cm, bottom=2.5cm"
date: "Goiânia, 16 de novembro de 2025"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(data.table)
library(dplyr)      
library(ggplot2)    
library(scales)     
library(tibble)     
library(knitr)      
knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  fig.align = "center",
  out.width = "75%"
)
```

```{r carregar-dados, echo=FALSE}
caminho_dados_finais <- "enem_2024_GOIAS_filtrado_final.csv"

dados_enem <- try(fread(caminho_dados_finais), silent = TRUE)
if (inherits(dados_enem, "try-error")) {
  message("Arquivo CSV não encontrado. Gerando dados de exemplo para compilar.")
  dados_enem <- data.table(
    TP_DEPENDENCIA_ADM_ESC = sample(1:4, 100, replace = TRUE, prob = c(0.1, 0.7, 0.05, 0.15)),
    TP_LINGUA = sample(0:1, 100, replace = TRUE),
    ACERTOS_CN = runif(100, 5, 35), NU_NOTA_CN = runif(100, 400, 750),
    ACERTOS_CH = runif(100, 10, 40), NU_NOTA_CH = runif(100, 450, 800),
    ACERTOS_LC = runif(100, 15, 42), NU_NOTA_LC = runif(100, 480, 820),
    ACERTOS_MT = runif(100, 5, 38), NU_NOTA_MT = runif(100, 450, 900),
    NU_NOTA_REDACAO = runif(100, 400, 980)
  )
}
```

# Introdução: Análise de Desempenho dos Concluintes do ENEM 2024 em Goiás

## Contexto e Objetivo

O objetivo central deste relatório é realizar uma análise descritiva, comparativa e preditiva detalhada dos resultados do ENEM 2024, focando especificamente no desempenho dos estudantes do estado de Goiás.

## Escopo da Análise e Metodologia

Para garantir a relevância e a precisão das conclusões, esta análise utiliza uma base de dados cuidadosamente filtrada, que se concentra em um público-alvo específico:

**Localização:** A análise restringe-se exclusivamente aos participantes do estado de Goiás (GO).

**Perfil do Aluno:** O estudo foca apenas nos participantes "regulares", ou seja, aqueles que estavam cursando e concluindo o 3º ano do Ensino Médio no ano de 2024.

**Participação:** Foram excluídos da base todos os participantes que faltaram em um ou nos dois dias de prova, bem como aqueles que foram eliminados.

Essa filtragem é crucial, pois garante que a análise de desempenho (notas e acertos) seja feita apenas sobre o grupo de alunos que efetivamente completou todo o ciclo avaliativo do exame.

## Estrutura do Relatório

A análise está estruturada em etapas progressivas para construir um entendimento completo dos dados:

**Análise de Variáveis Qualitativas:** Inicia-se traçando o perfil demográfico dos participantes, investigando a distribuição por Tipo de Escola (Federal, Estadual, Privada, Municipal) e a escolha da Língua Estrangeira (Inglês ou Espanhol).

**Análise de Variáveis Quantitativas:** O núcleo da análise descritiva, onde avaliamos o desempenho acadêmico. Esta seção é dividida em:

  **Análise de Acertos (Discretas):** Verificação do número de acertos em cada uma das quatro provas objetivas (Ciências da Natureza, Ciências Humanas, Linguagens e Matemática).

  **Análise de Notas (Contínuas):** Avaliação das notas finais (calculadas via TRI) e da nota da Redação.

Em ambas as subseções, são utilizadas medidas de tendência central e dispersão (média, mediana, quartis), e visualizações gráficas (Histogramas e Boxplots) para comparar o desempenho entre as áreas.

**Análise Comparativa (Cruzamento de Variáveis):** Esta seção aprofunda a investigação ao cruzar variáveis, buscando identificar padrões de desempenho. O foco é dado na comparação das notas de Matemática e Redação entre os diferentes tipos de administração escolar.

**Análise de Regressão Linear Simples:** Por fim, o relatório explora modelos preditivos simples para verificar a força da relação entre áreas correlatas, investigando se o desempenho em Ciências da Natureza pode prever a nota de Matemática, e se os acertos em Linguagens têm poder preditivo sobre a nota final da Redação.

# Análise das Variáveis Qualitativas

### Análise: Tipo de Escola (`TP_DEPENDENCIA_ADM_ESC`)
```{r analise-qualitativa-escola, echo=FALSE}
tabela_escola <- table(dados_enem$TP_DEPENDENCIA_ADM_ESC)

tabela_escola_porc <- round(100 * prop.table(tabela_escola), 2)

names(tabela_escola_porc) <- c("Federal", "Estadual", "Municipal", "Privada")

barplot(tabela_escola_porc,
        main="Tipo de Escola dos Participantes (GO)",
        ylab="Porcentagem (%)",
        xlab="Tipo de Dependência Administrativa",
        col="darkblue"
)
```

**Interpretação da Análise de Tipo de Escola**

A análise da `TP_DEPENDENCIA_ADM_ESC` mostra o perfil claro dos participantes de escolas de Goiás. A grande maioria, **`r tabela_escola_porc["Estadual"]`%**, provém de escolas **Estaduais**.

Em segundo lugar, com **`r tabela_escola_porc["Privada"]`%**, estão os alunos de escolas **Privadas**, seguidos por **`r tabela_escola_porc["Federal"]`%** de escolas **Federais**.

Como esperado para participantes do Ensino Médio, a participação de escolas **Municipais** é estatisticamente nula, com apenas **`r tabela_escola_porc["Municipal"]`%**.

### Análise: Tipo da Língua Estrangeira (`TP_LINGUA`)
```{r analise-lingua, echo=FALSE, message=FALSE, warning=FALSE}
library(dplyr)
library(ggplot2)
library(scales)

analise_lingua <- dados_enem %>%
  count(TP_LINGUA) %>%
  mutate(
    Lingua = case_when(
      TP_LINGUA == 0 ~ "Inglês",
      TP_LINGUA == 1 ~ "Espanhol"
    ),
    Porcentagem = n / sum(n) * 100
  )

ggplot(analise_lingua, aes(x = Lingua, y = n)) +
  geom_bar(stat = "identity", fill = "steelblue", color = "black", width = 0.6) +
  geom_text(aes(label = paste0(n, " (", round(Porcentagem, 1), "%)")), 
            vjust = -0.5, fontface = "bold") +
  scale_y_continuous(labels = scales::comma, expand = expansion(mult = c(0, 0.15))) +
  labs(
    title = "Distribuição da Escolha de Língua Estrangeira",
    subtitle = "Total de alunos presentes por idioma escolhido",
    x = "Idioma Escolhido",
    y = "Quantidade de Alunos"
  ) +
  theme_minimal() +
  theme(
    plot.title = element_text(size = 14, face = "bold"),
    axis.text = element_text(size = 11),
    panel.grid.major.x = element_blank()
  )

top_lingua <- analise_lingua %>% 
  filter(n == max(n))

bottom_lingua <- analise_lingua %>% 
  filter(n == min(n))

nome_maioria <- top_lingua$Lingua
qtd_maioria  <- format(top_lingua$n, big.mark = ".", decimal.mark = ",")
perc_maioria <- gsub("\\.", ",", round(top_lingua$Porcentagem, 1))

nome_minoria <- bottom_lingua$Lingua
qtd_minoria  <- format(bottom_lingua$n, big.mark = ".", decimal.mark = ",")
perc_minoria <- gsub("\\.", ",", round(bottom_lingua$Porcentagem, 1))
```

**Interpretação da Análise de Língua Estrangeira**

A distribuição da escolha de Língua Estrangeira apresenta um cenário competitivo, porém com uma liderança definida da língua **`r nome_maioria`**.

Observa-se que a maioria dos estudantes (**`r perc_maioria`%**, ou **`r qtd_maioria`** alunos) optou pelo **`r nome_maioria`** como idioma de prova, enquanto o **`r nome_minoria`** foi a escolha de **`r perc_minoria`%** (**`r qtd_minoria`** alunos).

Este dado é particularmente interessante quando cruzado com a análise anterior: mesmo com a grande predominância de alunos da rede estadual pública, a preferência pelo **`r nome_maioria`** se mostra superior neste grupo de concluintes.

# Análise das Variáveis Quantitativas Discretas EM CONJUNTO

### Estatísticas descritivas dos acertos ENEM
```{r medidas-descritivas-acertos, echo=FALSE}
library(dplyr)
library(tibble)

acertos <- dados_enem %>%
  select(ACERTOS_CN, ACERTOS_CH, ACERTOS_LC, ACERTOS_MT)

medidas <- function(x) {
  moda <- as.numeric(names(sort(table(x), decreasing = TRUE))[1])  
  media <- mean(x, na.rm = TRUE)
  mediana <- median(x, na.rm = TRUE)
  quartis <- quantile(x, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)
  variancia <- var(x, na.rm = TRUE)
  desvio <- sd(x, na.rm = TRUE)
  cv <- (desvio / media) * 100
  
  c(
    Média = media,
    Mediana = mediana,
    Moda = moda,
    Q1 = quartis[1],
    Q3 = quartis[3],
    Variância = variancia,
    `Desvio Padrão` = desvio,
    `Coeficiente de Variação (%)` = cv
  )
}

tabela_medidas <- data.frame(
  `Ciências da Natureza` = medidas(acertos$ACERTOS_CN),
  `Ciências Humanas` = medidas(acertos$ACERTOS_CH),
  `Linguagens` = medidas(acertos$ACERTOS_LC),
  `Matemática` = medidas(acertos$ACERTOS_MT)
)

tabela_medidas <- tibble::rownames_to_column(as.data.frame(tabela_medidas), "Medida")

knitr::kable(tabela_medidas, caption = "Medidas descritivas dos acertos do ENEM 2024", digits = 2)
```

### Tabelas de Frequências dos Acertos
```{r tabela-frequencias-unica, echo=FALSE}

freq_table <- function(vetor) {
  vetor <- na.omit(vetor)
  intervalos <- cut(
    vetor,
    breaks = seq(0, 50, by = 5),
    right = FALSE,
    include.lowest = TRUE
  )
  freq_abs <- table(intervalos)
  freq_rel <- round(prop.table(freq_abs) * 100, 2)
  freq_acum <- cumsum(freq_rel)
  
  data.frame(
    Intervalo = names(freq_abs),
    Absoluta = as.vector(freq_abs),
    Relativa = as.vector(freq_rel),
    Acumulada = as.vector(freq_acum)
  )
}

tab_cn <- freq_table(dados_enem$ACERTOS_CN)
tab_ch <- freq_table(dados_enem$ACERTOS_CH)
tab_mt <- freq_table(dados_enem$ACERTOS_MT)
tab_lc <- freq_table(dados_enem$ACERTOS_LC)

tabela_unica <- data.frame(
  Intervalo = tab_cn$Intervalo,
  CN_Abs = tab_cn$Absoluta,
  CH_Abs = tab_ch$Absoluta,
  MT_Abs = tab_mt$Absoluta,
  LC_Abs = tab_lc$Absoluta,
  
  `CN_Rel` = tab_cn$Relativa,
  `CH_Rel` = tab_ch$Relativa,
  `MT_Rel` = tab_mt$Relativa,
  `LC_Rel` = tab_lc$Relativa
)

knitr::kable(
  tabela_unica,
  caption = "Tabela Consolidada de Frequências – Acertos nas Quatro Áreas (GO)",
  align="c"
)
```

### Histogramas
```{r analise-discreta-acertos-conjunto, echo=FALSE}
cols_discretas <- c("ACERTOS_CN", "ACERTOS_CH", "ACERTOS_LC", "ACERTOS_MT")

medias_acertos <- round(sapply(dados_enem[, ..cols_discretas], mean, na.rm = TRUE), 2)
medianas_acertos <- sapply(dados_enem[, ..cols_discretas], median, na.rm = TRUE)
q1_acertos <- sapply(dados_enem[, ..cols_discretas], quantile, probs = 0.25, na.rm = TRUE, names = FALSE)
q3_acertos <- sapply(dados_enem[, ..cols_discretas], quantile, probs = 0.75, na.rm = TRUE, names = FALSE)

presentes_dia1 <- dados_enem[!is.na(NU_NOTA_CH) & !is.na(NU_NOTA_LC)] 
presentes_dia2 <- dados_enem[!is.na(NU_NOTA_CN) & !is.na(NU_NOTA_MT)] 

par(mfrow = c(2, 2))

hist(presentes_dia2$ACERTOS_CN, main="Acertos em CN (Presentes)", xlab="Acertos", ylab="Freq.", col="blue", breaks = seq(0, 45, by = 5), right = FALSE)
hist(presentes_dia1$ACERTOS_CH, main="Acertos em CH (Presentes)", xlab="Acertos", ylab="Freq.", col="red", breaks = seq(0, 45, by = 5), right = FALSE)
hist(presentes_dia1$ACERTOS_LC, main="Acertos em LC (Presentes)", xlab="Acertos", ylab="Freq.", col="green", breaks = seq(0, 45, by = 5), right = FALSE)
hist(presentes_dia2$ACERTOS_MT, main="Acertos em MT (Presentes)", xlab="Acertos", ylab="Freq.", col="purple", breaks = seq(0, 45, by = 5), right = FALSE)
```

**Interpretação Aprofundada dos Acertos**

A análise conjunta dos Histogramas e das Tabelas de Frequência e Estatísticas Descritivas revela padrões importantes sobre o desempenho dos candidatos:

**1. Forma da Distribuição (Histogramas)**
Observa-se uma **assimetria à direita** (positiva) em todas as áreas. Isso é corroborado pelo fato de a **Moda** (o pico dos gráficos) ser consistentemente menor que a **Mediana** e a **Média**. Isso indica que a prova é "difícil" para a maioria, com uma grande concentração de alunos nas faixas de notas mais baixas e poucos alunos alcançando pontuações altas (acima de 35 acertos).

**2. Desempenho Comparativo (Média e Mediana)**
Existe uma clara dicotomia entre as áreas do "Primeiro Dia" (Humanas e Linguagens) e do "Segundo Dia" (Natureza e Matemática):
* **Linguagens (LC)** e **Humanas (CH)** apresentam os melhores desempenhos, com medianas de **`r medianas_acertos["ACERTOS_LC"]`** e **`r medianas_acertos["ACERTOS_CH"]`** acertos, respectivamente.
* **Natureza (CN)** e **Matemática (MT)** mostram um desempenho significativamente inferior. Em Matemática, por exemplo, a mediana é de apenas **`r medianas_acertos["ACERTOS_MT"]`** acertos, o que significa que metade dos estudantes acertou menos de 25% da prova.

**3. Análise de Variabilidade (Coeficiente de Variação)**
A tabela de estatísticas descritivas traz um dado crucial: o **Coeficiente de Variação (CV%)**.
* **Matemática** possui a maior dispersão relativa (**50.01%**). Isso indica uma heterogeneidade imensa: enquanto uma vasta massa de alunos tem desempenho muito baixo, existe um grupo disperso que consegue notas maiores, esticando a cauda do gráfico.
* **Linguagens**, por outro lado, é a prova mais homogênea (CV de **35.54%**), sugerindo que o nível de conhecimento dos alunos nesta área é mais uniforme.

**4. Análise de Frequências (Intervalos Críticos)**
A Tabela Consolidada de Frequências detalha onde os alunos "travam":
* **O "Gargalo" de Matemática:** É alarmante notar que a faixa de **[5, 10)** acertos concentra a maior parte absoluta dos alunos de Matemática (15.084 estudantes). Somando-se os intervalos, a grande maioria dos candidatos não passa de 15 acertos.
* **O Padrão de Linguagens:** Diferente de MT e CN, o pico de frequência em Linguagens ocorre mais à frente, nos intervalos de **[15, 20)** e **[20, 25)**, reforçando que é uma prova onde o "chute" ou o conhecimento básico garantem uma pontuação mínima maior.

# Análise das Variáveis Quantitativas Contínuas EM CONJUNTO

### Estatísticas descritivas das notas ENEM
```{r medidas-descritivas-notas, echo=FALSE}
library(dplyr)
library(tibble)

notas <- dados_enem %>%
  select(NU_NOTA_CN, NU_NOTA_CH, NU_NOTA_LC, NU_NOTA_MT, NU_NOTA_REDACAO)

medidas <- function(x) {
  moda <- as.numeric(names(sort(table(x), decreasing = TRUE))[1])  
  media <- mean(x, na.rm = TRUE)
  mediana <- median(x, na.rm = TRUE)
  quartis <- quantile(x, probs = c(0.25, 0.5, 0.75), na.rm = TRUE)
  variancia <- var(x, na.rm = TRUE)
  desvio <- sd(x, na.rm = TRUE)
  cv <- (desvio / media) * 100
  
  c(
    Média = media,
    Mediana = mediana,
    Moda = moda,
    Q1 = quartis[1],
    Q3 = quartis[3],
    Variância = variancia,
    `Desvio Padrão` = desvio,
    `Coeficiente de Variação (%)` = cv
  )
}

tabela_medidas <- data.frame(
  `Ciências da Natureza` = medidas(notas$NU_NOTA_CN),
  `Ciências Humanas` = medidas(notas$NU_NOTA_CH),
  `Linguagens` = medidas(notas$NU_NOTA_LC),
  `Matemática` = medidas(notas$NU_NOTA_MT),
  `Redação` = medidas(notas$NU_NOTA_REDACAO)
)

tabela_medidas <- tibble::rownames_to_column(as.data.frame(tabela_medidas), "Medida")

knitr::kable(tabela_medidas, caption = "Medidas descritivas das notas do ENEM 2024", digits = 2)
```

### Histogramas
```{r analise-continua-notas-histograma, echo=FALSE}
par(mfrow = c(2, 3))

hist(dados_enem$NU_NOTA_CN,
     main = "Ciências da Natureza",
     xlab = "Nota",
     ylab = "Frequência",
     col = "darkgreen",
     breaks = 20)

hist(dados_enem$NU_NOTA_CH,
     main = "Ciências Humanas",
     xlab = "Nota",
     ylab = "Frequência",
     col = "darkblue",
     breaks = 20)

hist(dados_enem$NU_NOTA_LC,
     main = "Linguagens",
     xlab = "Nota",
     ylab = "Frequência",
     col = "darkorange",
     breaks = 20)

hist(dados_enem$NU_NOTA_REDACAO,
     main = "Redação",
     xlab = "Nota",
     ylab = "Frequência",
     col = "purple",
     breaks = 20)

hist(dados_enem$NU_NOTA_MT,
     main = "Matemática",
     xlab = "Nota",
     ylab = "Frequência",
     col = "darkred",
     breaks = 20)

par(mfrow = c(1, 1))
```

**Interpretação da Análise das Notas por Área do ENEM (GO)**

Os gráficos e medidas descritivas apresentados permitem analisar o comportamento das notas nas cinco áreas avaliadas pelo ENEM — *Ciências da Natureza*, *Ciências Humanas*, *Linguagens*, *Redação* e *Matemática* — entre os participantes de Goiás em 2024. De modo geral, os histogramas revelam que todas as áreas possuem distribuições com algum nível de assimetria, mas cada uma apresenta características próprias quando observamos seus valores centrais e a dispersão dos dados.

Nas provas objetivas (Natureza, Humanas, Linguagens e Matemática), observa-se uma concentração marcante de notas na faixa **entre 400 e 600 pontos**, evidenciada tanto nos histogramas quanto nas estatísticas centrais. As médias dessas áreas variam de aproximadamente **485 pontos** (Natureza) a **519 pontos** (Matemática), e as medianas seguem padrão semelhante, sempre próximas, reforçando a predominância de desempenhos intermediários. Além disso, todas apresentam **assimetria à direita**, indicando que uma parcela menor de estudantes alcança pontuações mais elevadas, enquanto a maior parte se concentra em torno das faixas medianas.

Apesar desse padrão comum, algumas diferenças se destacam. A prova de **Linguagens** mostra a **menor variabilidade relativa** entre todas as áreas (coeficiente de variação em torno de 13%), sugerindo que o desempenho dos estudantes nessa prova é mais homogêneo. Ciências Humanas também apresenta uma distribuição relativamente estável, com média em torno de **501 pontos** e desvio-padrão moderado. Em contraste, **Matemática** exibe dispersão mais ampla e uma cauda longa no extremo superior dos histogramas, mostrando maior distância entre estudantes de baixo e alto desempenho. Já **Ciências da Natureza** apresenta a menor média entre todas as áreas, indicando que muitos estudantes enfrentam dificuldades nessa prova.

A prova de **Redação**, porém, apresenta um comportamento claramente distinto. Sua média elevada, acima de **640 pontos**, e mediana ainda maior, em torno de **660 pontos**, indicam que grande parte dos estudantes obtém notas altas. No entanto, o desvio-padrão bastante elevado e o maior coeficiente de variação entre todas as áreas mostram que essa prova possui a maior **heterogeneidade** de desempenho. Essa variação é confirmada pelos histogramas, que revelam distribuição mais espalhada, múltiplos picos e presença de notas muito baixas (entre 0 e 200), ao mesmo tempo em que muitos participantes atingem faixas próximas a 800 pontos.

No conjunto, os resultados indicam que os participantes de Goiás tiveram desempenho relativamente melhor nas áreas de **Linguagens** e **Redação**, enquanto **Ciências da Natureza** e **Matemática** continuam apresentando maiores dificuldades, com médias mais baixas e distribuições mais dispersas.

# Análise Comparativa (Cruzamento de Variáveis)

Esta é a parte mais importante da análise descritiva, onde cruzamos variáveis qualitativas e quantitativas.

### Análise: Nota de Matemática vs. Tipo de Escola
```{r analise-comparativa-boxplot, echo=FALSE}
rotulos_escola <- c("Federal", "Estadual", "Municipal", "Privada")
cores_escola <- c("blue", "green", "orange", "red")

boxplot(dados_enem$NU_NOTA_MT ~ dados_enem$TP_DEPENDENCIA_ADM_ESC,
        main="Notas de Mat. por Tipo de Escola",
        ylab="Nota de Matemática",
        xlab="Tipo de Escola",
        names = rotulos_escola,  
        col = cores_escola       
)

medianas_por_grupo <- tapply(dados_enem$NU_NOTA_MT,
                                 dados_enem$TP_DEPENDENCIA_ADM_ESC,
                                 median,
                                 na.rm = TRUE)

med_federal <- round(medianas_por_grupo["1"], 2)
med_estadual <- round(medianas_por_grupo["2"], 2)
med_municipal <- round(medianas_por_grupo["3"], 2)
med_privada <- round(medianas_por_grupo["4"], 2)
```

**Interpretação da Análise Comparativa**

Esse gráfico boxplot é uma das análises mais reveladoras deste trabalho, pois compara o desempenho em Matemática entre os diferentes tipos de administração escolar.

Ao analisar os dados, observamos a seguinte hierarquia de desempenho:

1.  **Escolas Privadas (1º Lugar):** Neste conjunto de dados, a rede privada assume a liderança. A mediana deste grupo é de **`r med_privada`** pontos, destacando-se com o maior valor central entre as categorias.
2.  **Escolas Federais (2º Lugar):** Ficam na segunda posição, com uma mediana de **`r med_federal`** pontos. Embora mantenham um desempenho alto, neste recorte específico ficaram abaixo da rede privada.
3.  **Escolas Municipais:** Apresentam um comportamento atípico. Mesmo sendo um grupo estatisticamente muito pequeno (**`r tabela_escola_porc["Municipal"]`%** da amostra), sua mediana foi de **`r med_municipal`** pontos, superando a rede estadual.
4.  **Escolas Estaduais:** Este grupo, que representa a vasta maioria dos participantes (**`r tabela_escola_porc["Estadual"]`%**), apresenta o menor desempenho comparativo, com uma mediana de **`r med_estadual`** pontos.

### Análise: Nota da Redação vs. Tipo de Escola
```{r analise-comparativa-boxplot-redacao, echo=FALSE}
rotulos_escola <- c("Federal", "Estadual", "Municipal", "Privada")
cores_escola <- c("blue", "green", "orange", "red")

boxplot(dados_enem$NU_NOTA_RED ~ dados_enem$TP_DEPENDENCIA_ADM_ESC,
        main="Nota de Redação por Tipo de Escola",
        ylab="Nota de Redação",
        xlab="Tipo de Escola",
        names = rotulos_escola,
        col = cores_escola
)

medianas_por_grupo <- tapply(dados_enem$NU_NOTA_RED,
                             dados_enem$TP_DEPENDENCIA_ADM_ESC,
                             median,
                             na.rm = TRUE)

med_federal <- round(medianas_por_grupo["1"], 2)
med_estadual <- round(medianas_por_grupo["2"], 2)
med_municipal <- round(medianas_por_grupo["3"], 2)
med_privada <- round(medianas_por_grupo["4"], 2)
```

**Interpretação da Análise Comparativa**

O gráfico que compara o desempenho em Redação entre os diferentes tipos de administração escolar também revela diferenças importantes entre os grupos analisados.

Os resultados seguem uma tendência clara:

1.  **Escolas Federais:** Ficam em segundo lugar, com mediana de **`r med_federal`** pontos.
Embora apresentem excelentes resultados, ainda ficam ligeiramente abaixo das escolas privadas no desempenho mediano.

2.  **Escolas Privadas:** Apresentam o melhor desempenho em Redação.
A mediana deste grupo é de **`r med_privada`** pontos, a maior entre todas as categorias, indicando um desempenho consistentemente superior.

3.  **Escolas Municipais:** Este grupo, que possui participação reduzida (**`r tabela_escola_porc["Municipal"]`%**), apresenta a menor mediana entre os tipos de escola, com **`r med_municipal`** pontos.
O resultado reflete desafios estruturais mais evidentes nessa rede.

4.  **Escolas Estaduais:** Representando a maior parcela dos participantes (**`r tabela_escola_porc["Estadual"]`%**), apresentam uma mediana de **`r med_estadual`** pontos — inferior às redes Federal e Privada, mas superior às Municipais.

# Análise de Regressão Linear Simples

O foco da análise de regressão linear simples serve para verificar se uma variável quantitativa pode prever o comportamento de outra.

### Análise: `NU_NOTA_MT (Variável Dependente)`   VS   `NU_NOTA_CN (Variável Independente)`

Para esta análise, vamos investigar se a nota em **Ciências da Natureza (`NU_NOTA_CN`)** pode ser usada para prever a nota em **Matemática (`NU_NOTA_MT`)**.

```{r analise-regressao, echo=FALSE}
modelo_regressao <- lm(NU_NOTA_MT ~ NU_NOTA_CN, data = dados_enem)

summary_modelo <- summary(modelo_regressao)

coeficientes <- summary_modelo$coefficients
intercepto_b0 <- round(coeficientes[1, 1], 4) 
slope_b1 <- round(coeficientes[2, 1], 4)      
p_valor <- coeficientes[2, 4]                 

r_quadrado <- round(summary_modelo$r.squared, 4)

plot(dados_enem$NU_NOTA_CN, dados_enem$NU_NOTA_MT,
     main="Regressão Linear - Nota Mat. vs. Nota CN",
     xlab="Nota Ciências da Natureza (X)",
     ylab="Nota Matemática (Y)",
     pch = 19, 
     cex = 0.5, 
     col = "blue"
)

abline(modelo_regressao, col = "red", lwd = 3) 
```

**Interpretação da Análise de Regressão**

Esse gráfico mostra o diagrama de dispersão entre as notas de Ciências da Natureza (eixo X) e Matemática (eixo Y). A linha vermelha representa o modelo de regressão linear simples.

Visualmente, os pontos formam uma nuvem que sobe da esquerda para a direita, indicando uma **correlação linear positiva** entre as duas variáveis: quanto maior a nota em CN, maior tende a ser a nota em MT.

**Interpretação do Modelo Estatístico**

O resumo do modelo estatístico nos fornece os seguintes indicadores-chave:

1.  **Coeficientes (A Equação da Reta):**
    * **Intercepto (B0):** `r intercepto_b0`. Este é o valor teórico da nota de Matemática se a nota de CN fosse zero.
    * **Slope (B1 - `NU_NOTA_CN`):** `r slope_b1`. Este é o coeficiente mais importante. Ele indica que, em média, para cada **1 ponto** de aumento na nota de Ciências da Natureza, espera-se um aumento de **`r slope_b1`** pontos na nota de Matemática.

2.  **Coeficiente de Determinação (R²):**
    * O R-quadrado do modelo foi de **`r r_quadrado`**. Isso significa que **`r r_quadrado * 100`%** da variação nas notas de Matemática podem ser estatisticamente explicadas pela variação nas notas de Ciências da Natureza.

3.  **Significância (P-Valor):**
    * O P-valor para o coeficiente B1 foi de **`r p_valor`** (ou um valor muito próximo de zero). Como este valor é muito menor que 0.05, confirmamos que a relação entre as duas notas é **estatisticamente significante**.

### Análise: `NU_NOTA_REDACAO (Variável Dependente)`   VS   `ACERTOS_LC (Variável Independente)`

O objetivo desta próxima análise é verificar se o desempenho do participante em **Linguagens e Códigos (ACERTOS_LC)** pode ser usado para prever sua **nota de Redação (NU_NOTA_REDACAO)**.

```{r regressao-red-lc, echo=FALSE}
modelo_red_lc <- lm(NU_NOTA_REDACAO ~ ACERTOS_LC, data = dados_enem)

summary_red_lc <- summary(modelo_red_lc)

coeficientes <- summary_red_lc$coefficients
intercepto_b0 <- round(coeficientes[1, 1], 4)   
slope_b1 <- round(coeficientes[2, 1], 4)        
p_valor <- coeficientes[2, 4]                   
r_quadrado <- round(summary_red_lc$r.squared, 4) 

plot(dados_enem$ACERTOS_LC, dados_enem$NU_NOTA_REDACAO,
     main="Regressão Linear - Nota Redação vs. Acertos em LC",
     xlab="Acertos em Linguagens (X)",
     ylab="Nota de Redação (Y)",
     pch = 19,
     cex = 0.5,
     col = "blue"
)

abline(modelo_red_lc, col = "red", lwd = 3)
```

**Interpretação da Análise de Regressão**

O gráfico acima mostra o diagrama de dispersão entre o número de acertos em Linguagens (eixo X) e a nota de Redação (eixo Y). A linha vermelha representa o modelo de regressão linear simples.

Visualmente, os pontos formam uma nuvem que sobe da esquerda para a direita, indicando uma **correlação linear positiva** entre as duas variáveis: quanto maior o número de acertos em LC, maior tende a ser a nota de Redação.

**Interpretação do Modelo Estatístico**

O resumo do modelo estatístico nos fornece os seguintes indicadores-chave:

1. **Coeficientes (A Equação da Reta)**
    * **Intercepto (B0):** `r intercepto_b0`.  
  Este é o valor teórico da nota de Redação caso o participante tivesse **0 acertos em Linguagens**.
    * **Slope (B1 – ACERTOS_LC):** `r slope_b1`.  
  Esse é o coeficiente mais importante. Ele indica que, em média, para cada **1 acerto adicional** em Linguagens, espera-se um aumento de **`r slope_b1`** pontos na nota de Redação.

2. **Coeficiente de Determinação (R²)**
    * O R-quadrado encontrado foi de **`r r_quadrado`**.  
Isso significa que **`r r_quadrado * 100`%** da variação nas notas de Redação pode ser explicada pelas diferenças no número de acertos em Linguagens.

3. **Significância (P-Valor)**
    * O P-valor do coeficiente B1 é **`r p_valor`** (muito próximo de zero).  
Como este valor é muito menor que 0.05, concluímos que a relação entre acertos em LC e nota de Redação é **estatisticamente significante**.